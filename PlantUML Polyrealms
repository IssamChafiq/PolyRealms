@startuml

package "Game Layer" {
  class Game {
    +players : List<Player>
    +market : Market
    +currentTurn : Turn
    +start()
    +nextTurn()
    +checkWinner() : Player
  }

  class Turn {
    +player : Player
    +phase : Phase
    +start()
    +main()
    +cleanup()
  }

  enum Phase {
    Start
    Main
    Cleanup
  }
}

package "Table Layer" {
  class Player {
    +name : String
    +authority : int
    +gold : int
    +combat : int
    +deck : Deck
    +hand : Hand
    +discard : DiscardPile
    +inPlay : List<Card>
    +champions : List<Champion>
    +draw(n:int)
    +play(card:Card)
    +buy(card:Card, market:Market)
    +attack(target:Player, amount:int)
    +cleanup()
  }

  class Deck {
    +cards : Stack<Card>
    +shuffle()
    +draw(n:int) : List<Card>
  }

  class Hand {
    +cards : List<Card>
    +add(card:Card)
    +remove(card:Card)
  }

  class DiscardPile {
    +cards : List<Card>
    +add(card:Card)
  }

  class Market {
    +tradeRow : List<Card>
    +fireGemStack : int
    +tradeDeck : Deck
    +sell(card:Card)
  }
}

package "Cards Layer" {
  abstract class Card {
    +name
    +cost
    +faction
    +type
    +expendable
    +expended
    +sacrificeable
    +sacrificed
    +abilities
    +onPlay()
    +onExpend()
    +onSacrifice()
    +onNewTurn()
    +hasAllySameFaction()
    +removeSelfFromPlayerZones()
  }

  class ActionCard

  class Champion extends Card {
    +defense
    +isGuard
    +stunned
    +canBeAttacked()
    +applyDamage()
  }

  class CardAbility {
    +trigger
    +ability
    +amount
    +requiresAlly
  }

  class Abilities {
    +execute()
    +gainGold()
    +gainCombat()
    +gainAuthority()
    +drawCards()
    +stunTargetChampion()
    +prepareFriendlyChampion()
    +sacrificeSelf()
    +acquireToTop()
    +opponentDiscardsOne()
  }

  enum Faction {
    Imperial
    Guild
    Necros
    Wild
    Neutral
  }

  enum CardType {
    Action
    Champion
  }

  enum Trigger {
    OnPlay
    Expend
    Sacrificea
    NewTurn
  }

  enum AbilityName {
    GainGold
    GainCombat
    GainAuthority
    DrawCards
    StunTargetChampion
    PrepareFriendlyChampion
    SacrificeSelf
    AcquireToTop
    OpponentDiscardsOne
  }
}

Game "1" o-- "2..4" Player
Game "1" *-- "1" Market
Game "1" *-- "1" Turn

Player "1" *-- "1" Deck
Player "1" *-- "1" Hand
Player "1" *-- "1" DiscardPile
Player "1" o-- "*" Champion
Player "1" o-- "*" Card : inPlay

Card "1" o-- "*" CardAbility

Champion -up-|> Card
ActionCard -up-|> Card

Deck "1" o-- "0..*" Card
Hand "1" o-- "0..*" Card
DiscardPile "1" o-- "0..*" Card
Market "1" o-- "5" Card : tradeRow
Market "1" *-- "1" Deck : tradeDeck

@enduml
